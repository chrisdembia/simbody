<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Simbody: Geo_BicubicBezierPatch.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simbody
   &#160;<span id="projectnumber">3.4 (development)</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('Geo__BicubicBezierPatch_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Geo_BicubicBezierPatch.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Geo__BicubicBezierPatch_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef SimTK_SIMMATH_GEO_BICUBIC_BEZIER_PATCH_H_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define SimTK_SIMMATH_GEO_BICUBIC_BEZIER_PATCH_H_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="comment">/* -------------------------------------------------------------------------- *</span>
<a name="l00005"></a>00005 <span class="comment"> *                        Simbody(tm): SimTKmath                              *</span>
<a name="l00006"></a>00006 <span class="comment"> * -------------------------------------------------------------------------- *</span>
<a name="l00007"></a>00007 <span class="comment"> * This is part of the SimTK biosimulation toolkit originating from           *</span>
<a name="l00008"></a>00008 <span class="comment"> * Simbios, the NIH National Center for Physics-Based Simulation of           *</span>
<a name="l00009"></a>00009 <span class="comment"> * Biological Structures at Stanford, funded under the NIH Roadmap for        *</span>
<a name="l00010"></a>00010 <span class="comment"> * Medical Research, grant U54 GM072970. See https://simtk.org/home/simbody.  *</span>
<a name="l00011"></a>00011 <span class="comment"> *                                                                            *</span>
<a name="l00012"></a>00012 <span class="comment"> * Portions copyright (c) 2011-12 Stanford University and the Authors.        *</span>
<a name="l00013"></a>00013 <span class="comment"> * Authors: Michael Sherman                                                   *</span>
<a name="l00014"></a>00014 <span class="comment"> * Contributors:                                                              *</span>
<a name="l00015"></a>00015 <span class="comment"> *                                                                            *</span>
<a name="l00016"></a>00016 <span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may    *</span>
<a name="l00017"></a>00017 <span class="comment"> * not use this file except in compliance with the License. You may obtain a  *</span>
<a name="l00018"></a>00018 <span class="comment"> * copy of the License at http://www.apache.org/licenses/LICENSE-2.0.         *</span>
<a name="l00019"></a>00019 <span class="comment"> *                                                                            *</span>
<a name="l00020"></a>00020 <span class="comment"> * Unless required by applicable law or agreed to in writing, software        *</span>
<a name="l00021"></a>00021 <span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,          *</span>
<a name="l00022"></a>00022 <span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   *</span>
<a name="l00023"></a>00023 <span class="comment"> * See the License for the specific language governing permissions and        *</span>
<a name="l00024"></a>00024 <span class="comment"> * limitations under the License.                                             *</span>
<a name="l00025"></a>00025 <span class="comment"> * -------------------------------------------------------------------------- */</span>
<a name="l00026"></a>00026 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="SimTKcommon_8h.html" title="Includes internal headers providing declarations for the basic SimTK Core classes, including Simmatrix.">SimTKcommon.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="SimTKmath_2include_2simmath_2internal_2common_8h.html" title="This is the header file that every Simmath compilation unit should include first.">simmath/internal/common.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="Geo_8h.html" title="Defines geometric primitive shapes and algorthms.">simmath/internal/Geo.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="Geo__CubicBezierCurve_8h.html" title="Provides primitive operations for a single bicubic Bezier curve using either single or double precisi...">simmath/internal/Geo_CubicBezierCurve.h</a>&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="keyword">namespace </span>SimTK {
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">//==============================================================================</span>
<a name="l00044"></a>00044 <span class="comment">//                         GEO BICUBIC BEZIER PATCH</span>
<a name="l00045"></a>00045 <span class="comment">//==============================================================================</span>
<a name="l00100"></a>00100 <span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> P&gt;
<a name="l00101"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html">00101</a> <span class="keyword">class </span><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">Geo::BicubicBezierPatch_</a> {
<a name="l00102"></a>00102 <span class="keyword">typedef</span> P               RealP;
<a name="l00103"></a>00103 <span class="keyword">typedef</span> <a class="code" href="classSimTK_1_1Vec.html">Vec&lt;3,RealP&gt;</a>    <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="keyword">public</span>:
<a name="l00107"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ace2294f1190b89f70a463ff4dd3e9f19">00107</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ace2294f1190b89f70a463ff4dd3e9f19" title="Construct an uninitialized patch; control points will be garbage.">BicubicBezierPatch_</a>() {}
<a name="l00108"></a>00108 
<a name="l00113"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a4fc6cc7b4d138c537b3e396f87895763">00113</a> <span class="keyword">explicit</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ace2294f1190b89f70a463ff4dd3e9f19" title="Construct an uninitialized patch; control points will be garbage.">BicubicBezierPatch_</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; controlPoints) 
<a name="l00114"></a>00114 :   B(controlPoints) {} 
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 
<a name="l00120"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a6be71f41cbf5d2ec618df747c1a5ce6d">00120</a> <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a6be71f41cbf5d2ec618df747c1a5ce6d" title="Evaluate a point P(u,w) on this patch given values for the parameters u and w in [0,1].">evalP</a>(RealP u, RealP w)<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a2a1988ebd2e5967aca7f60b3d71ddde8" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the point P(u,w)=Fb(u)*B*~Fb(w) at that location, where Fb is a vector of Bezier basis functions.">evalPUsingB</a>(B,u,w);}
<a name="l00121"></a>00121 
<a name="l00125"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a9dcdbc1d1bf36c4efa5f2c72dc9ba70c">00125</a> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a9dcdbc1d1bf36c4efa5f2c72dc9ba70c" title="Evaluate the tangents Pu=dP/du, Pw=dP/dw on this patch given values for the parameters u and w in [0...">evalP1</a>(RealP u, RealP w, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pu, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pw)<span class="keyword"> const </span>
<a name="l00126"></a>00126 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae7b2f8c0bb9fa289571cdaa23639f0dd" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the tangents Pu(u,w)=dFb(u)*B*~Fb(w) and Pw(u,w)=Fb(u)*B*~dFb(w) at that location.">evalP1UsingB</a>(B,u,w,Pu,Pw); }
<a name="l00127"></a>00127 
<a name="l00132"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#abf9a062f337c0000ab08c265012313cc">00132</a> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#abf9a062f337c0000ab08c265012313cc" title="Evaluate the second derivatives Puu=d2P/du2, Pww=d2P/dw2, and cross derivative Puw=Pwu=d2P/dudw on th...">evalP2</a>(RealP u, RealP w, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puu, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puw, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pww)<span class="keyword"> const </span>
<a name="l00133"></a>00133 <span class="keyword"></span>{   <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ab6e2ee49dc5b437dc9b0e388d3c78fae" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the second derivatives Puu(u,w)=d2Fb(u)*B*~Fb(w), Puw(u,w)=dFb(u)*B*~dFb(w) and Pww(u,w)=Fb(u)*B*~d2Fb(w) at that location.">evalP2UsingB</a>(B,u,w,Puu,Puw,Pww); }
<a name="l00134"></a>00134 
<a name="l00139"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a8b4fccaa571b51b3221a17446bf77340">00139</a> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a8b4fccaa571b51b3221a17446bf77340" title="Evaluate the third derivatives Puuu=d3P/du3, Pwww=d3P/dw3, and cross derivatives Puuw=Pwuu=Puwu=d3P/d...">evalP3</a>(RealP u, RealP w, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puuu, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puuw, 
<a name="l00140"></a>00140                               <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puww, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pwww)<span class="keyword"> const </span>
<a name="l00141"></a>00141 <span class="keyword"></span>{   <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3226ab4adc8cc797c3ece56a65f77fb7" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the third derivatives Puuu(u,w)=d3Fb(u)*B*~Fb(w), Puuw(u,w)=d2Fb(u)*B*~dFb(w), Puww(u,w)=dFb(u)*B*~d2Fb(w) and Pwww(u,w)=Fb(u)*B*~d3Fb(w) at that location.">evalP3UsingB</a>(B,u,w,Puuu,Puuw,Puww,Pwww); }
<a name="l00142"></a>00142 
<a name="l00146"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ab9b8e6c29801ce5279532837574ec294">00146</a> <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ab9b8e6c29801ce5279532837574ec294" title="Return a reference to the Bezier control points B that are stored in this object.">getControlPoints</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> B;}
<a name="l00150"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a58a32a4499d1f5b0bc3f51dd837e03cf">00150</a> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a58a32a4499d1f5b0bc3f51dd837e03cf" title="Return a writable reference to the Bezier control points B that are stored in this object...">updControlPoints</a>() {<span class="keywordflow">return</span> B;}
<a name="l00154"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a29e92ada1c775354c86b8236de217aa7">00154</a> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a29e92ada1c775354c86b8236de217aa7" title="Calculate the algebraic coefficients A from the stored Bezier control points.">calcAlgebraicCoefficients</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#aa0ace21fdf4c99e3bf5f74b5ae893524" title="Given the Bezier control points B, return the equivalent vector algebraic coefficients A...">calcAFromB</a>(B);}
<a name="l00158"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ad8a0c4c6fff5f6fe5a73ff4c49647b15">00158</a> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ad8a0c4c6fff5f6fe5a73ff4c49647b15" title="Calculate the Hermite coefficients H from the stored Bezier control points.">calcHermiteCoefficients</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae8ddc97035940c8db83bb4a92da17bac" title="Given the Bezier control points B, return the equivalent vector Hermite coefficients H...">calcHFromB</a>(B);}
<a name="l00159"></a>00159 
<a name="l00163"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#aef462811364acf81fb1dc472dda95db2">00163</a> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#aef462811364acf81fb1dc472dda95db2" title="Return the u=0 boundary curve as a Bezier curve segment.">getBoundaryCurveU0</a>()<span class="keyword"> const </span>
<a name="l00164"></a>00164 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B[0]); } <span class="comment">// b11 b12 b13 b14</span>
<a name="l00168"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a0e0faa454815c7825c4d81a580e749cc">00168</a> <span class="comment"></span><a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a0e0faa454815c7825c4d81a580e749cc" title="Return the u=1 boundary curve as a Bezier curve segment.">getBoundaryCurveU1</a>()<span class="keyword"> const </span>
<a name="l00169"></a>00169 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B[3]); } <span class="comment">// b41 b42 b43 b44</span>
<a name="l00173"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a894ce3ff9d41456a7b94c9094b69bbbb">00173</a> <span class="comment"></span><a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a894ce3ff9d41456a7b94c9094b69bbbb" title="Return the w=0 boundary curve as a Bezier curve segment.">getBoundaryCurveW0</a>()<span class="keyword"> const </span>
<a name="l00174"></a>00174 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B(0)); } <span class="comment">// b11 b21 b31 b41</span>
<a name="l00178"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae0cdbd75098b1c5b2ef14a0aa66d427e">00178</a> <span class="comment"></span><a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae0cdbd75098b1c5b2ef14a0aa66d427e" title="Return the w=1 boundary curve as a Bezier curve segment.">getBoundaryCurveW1</a>()<span class="keyword"> const </span>
<a name="l00179"></a>00179 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B(3)); } <span class="comment">// b14 b24 b34 b44</span>
<a name="l00180"></a>00180 
<a name="l00184"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a5712ceee630ada5eb4c548a6cca18e4c">00184</a> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a5712ceee630ada5eb4c548a6cca18e4c" title="Given a particular value u0 for patch coordinate u, create a cubic Bezier curve segment P(w)=P(u0...">calcIsoCurveU</a>(RealP u0)<span class="keyword"> const </span>
<a name="l00185"></a>00185 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a5712ceee630ada5eb4c548a6cca18e4c" title="Given a particular value u0 for patch coordinate u, create a cubic Bezier curve segment P(w)=P(u0...">calcIsoCurveU</a>(B, u0); }
<a name="l00189"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3944ac99fa1618353bfb1a2b7dae70a6">00189</a> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3944ac99fa1618353bfb1a2b7dae70a6" title="Given a particular value w0 for patch coordinate w, create a cubic Bezier curve segment P(u)=P(u...">calcIsoCurveW</a>(RealP w0)<span class="keyword"> const </span>
<a name="l00190"></a>00190 <span class="keyword"></span>{   <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3944ac99fa1618353bfb1a2b7dae70a6" title="Given a particular value w0 for patch coordinate w, create a cubic Bezier curve segment P(u)=P(u...">calcIsoCurveW</a>(B, w0); }
<a name="l00191"></a>00191 
<a name="l00206"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afd768d584098dca52fd6b3a4f666ed3a">00206</a> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afd768d584098dca52fd6b3a4f666ed3a" title="Split this patch into two along the u direction, along an isoparametric curve of constant u=t such th...">splitU</a>(RealP u, <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch0, 
<a name="l00207"></a>00207                      <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch1)<span class="keyword"> const </span>{
<a name="l00208"></a>00208     <span class="keyword">const</span> RealP tol = getDefaultTol&lt;RealP&gt;();
<a name="l00209"></a>00209     <a class="code" href="ExceptionMacros_8h.html#aecf81226de701d6eb7ab996358739d6a">SimTK_ERRCHK1</a>(tol &lt;= u &amp;&amp; u &lt;= 1-tol, <span class="stringliteral">&quot;Geo::BicubicBezierPatch::splitU()&quot;</span>,
<a name="l00210"></a>00210         <span class="stringliteral">&quot;Can&#39;t split patch at parameter u=%g; it is either out of range or&quot;</span>
<a name="l00211"></a>00211         <span class="stringliteral">&quot; too close to an edge.&quot;</span>, (<span class="keywordtype">double</span>)u);
<a name="l00212"></a>00212     <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> l,h;
<a name="l00213"></a>00213     <span class="keywordflow">if</span> (u==RealP(0.5)) <span class="comment">// bisecting</span>
<a name="l00214"></a>00214         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; ++i) {
<a name="l00215"></a>00215             <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B(i)).bisect(l,h);
<a name="l00216"></a>00216             patch0.B(i) = l.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>(); 
<a name="l00217"></a>00217             patch1.B(i) = h.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>();
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219     <span class="keywordflow">else</span> 
<a name="l00220"></a>00220         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; ++i) {
<a name="l00221"></a>00221             <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B(i)).<a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ac5b2d36fcdce219eba68f753d8158f34" title="Split this patch into four subpatches at a particular parametric point (u,w) such that 0 &lt; u...">split</a>(u,l,h);
<a name="l00222"></a>00222             patch0.B(i) = l.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>(); 
<a name="l00223"></a>00223             patch1.B(i) = h.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>();
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00241"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a390a963fac70b68e5b61da6e1ac0c9e2">00241</a> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a390a963fac70b68e5b61da6e1ac0c9e2" title="Split this patch into two along the w direction, along an isoparametric curve of constant w=t such th...">splitW</a>(RealP w, <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch0, 
<a name="l00242"></a>00242                      <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch1)<span class="keyword"> const </span>{
<a name="l00243"></a>00243     <span class="keyword">const</span> RealP tol = getDefaultTol&lt;RealP&gt;();
<a name="l00244"></a>00244     <a class="code" href="ExceptionMacros_8h.html#aecf81226de701d6eb7ab996358739d6a">SimTK_ERRCHK1</a>(tol &lt;= w &amp;&amp; w &lt;= 1-tol, <span class="stringliteral">&quot;Geo::BicubicBezierPatch::splitW()&quot;</span>,
<a name="l00245"></a>00245         <span class="stringliteral">&quot;Can&#39;t split patch at parameter w=%g; it is either out of range or&quot;</span>
<a name="l00246"></a>00246         <span class="stringliteral">&quot; too close to an edge.&quot;</span>, (<span class="keywordtype">double</span>)w);
<a name="l00247"></a>00247     <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> l,h;
<a name="l00248"></a>00248     <span class="keywordflow">if</span> (w==RealP(0.5)) <span class="comment">// bisecting</span>
<a name="l00249"></a>00249         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; ++i) {
<a name="l00250"></a>00250             <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B[i]).bisect(l,h);
<a name="l00251"></a>00251             patch0.B[i] = l.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>().positionalTranspose(); 
<a name="l00252"></a>00252             patch1.B[i] = h.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>().positionalTranspose();
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254     <span class="keywordflow">else</span> 
<a name="l00255"></a>00255         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; ++i) {
<a name="l00256"></a>00256             <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(B[i]).<a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ac5b2d36fcdce219eba68f753d8158f34" title="Split this patch into four subpatches at a particular parametric point (u,w) such that 0 &lt; u...">split</a>(w,l,h);
<a name="l00257"></a>00257             patch0.B[i] = l.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>().positionalTranspose(); 
<a name="l00258"></a>00258             patch1.B[i] = h.<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html#aa3b6a6db263373ce49ebe85734b9fede" title="Return a reference to the Bezier control points B=[b0 b1 b2 b3] that are stored in this object...">getControlPoints</a>().positionalTranspose();
<a name="l00259"></a>00259         }
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 
<a name="l00278"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ac5b2d36fcdce219eba68f753d8158f34">00278</a> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ac5b2d36fcdce219eba68f753d8158f34" title="Split this patch into four subpatches at a particular parametric point (u,w) such that 0 &lt; u...">split</a>(RealP u, RealP w, <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch00, 
<a name="l00279"></a>00279                              <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch01, 
<a name="l00280"></a>00280                              <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch10, 
<a name="l00281"></a>00281                              <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a>&amp; patch11)<span class="keyword"> const </span>{
<a name="l00282"></a>00282     <span class="keyword">const</span> RealP tol = getDefaultTol&lt;RealP&gt;();
<a name="l00283"></a>00283     <a class="code" href="ExceptionMacros_8h.html#a57ba111f3c249a666b141d802807daa1">SimTK_ERRCHK2</a>((tol &lt;= u &amp;&amp; u &lt;= 1-tol) &amp;&amp; (tol &lt;= w &amp;&amp; w &lt;= 1-tol), 
<a name="l00284"></a>00284         <span class="stringliteral">&quot;Geo::BicubicBezierPatch::split()&quot;</span>,
<a name="l00285"></a>00285         <span class="stringliteral">&quot;Can&#39;t split patch at parametric point u,w=%g,%g; it is either out of&quot;</span>
<a name="l00286"></a>00286         <span class="stringliteral">&quot; range or too close to an edge.&quot;</span>, (<span class="keywordtype">double</span>)u, (<span class="keywordtype">double</span>)w);
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html" title="A primitive useful for computations involving a single bicubic Bezier patch.">BicubicBezierPatch_&lt;P&gt;</a> patch0, patch1; <span class="comment">// results of the first split</span>
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <span class="comment">// We split once along one direction, and then twice along the other, so</span>
<a name="l00291"></a>00291     <span class="comment">// make sure the second direction is the cheap bisecting one.</span>
<a name="l00292"></a>00292     <span class="keywordflow">if</span> (u == Real(0.5)) {
<a name="l00293"></a>00293         <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a390a963fac70b68e5b61da6e1ac0c9e2" title="Split this patch into two along the w direction, along an isoparametric curve of constant w=t such th...">splitW</a>(w,patch0,patch1);            <span class="comment">// 120 or 180 flops</span>
<a name="l00294"></a>00294         patch0.<a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afd768d584098dca52fd6b3a4f666ed3a" title="Split this patch into two along the u direction, along an isoparametric curve of constant u=t such th...">splitU</a>(u, patch00, patch10); <span class="comment">// 120 flops</span>
<a name="l00295"></a>00295         patch1.<a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afd768d584098dca52fd6b3a4f666ed3a" title="Split this patch into two along the u direction, along an isoparametric curve of constant u=t such th...">splitU</a>(u, patch01, patch11); <span class="comment">// 120 flops</span>
<a name="l00296"></a>00296     } <span class="keywordflow">else</span> {
<a name="l00297"></a>00297         <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afd768d584098dca52fd6b3a4f666ed3a" title="Split this patch into two along the u direction, along an isoparametric curve of constant u=t such th...">splitU</a>(u,patch0,patch1);            <span class="comment">// 180 flops</span>
<a name="l00298"></a>00298         patch0.<a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a390a963fac70b68e5b61da6e1ac0c9e2" title="Split this patch into two along the w direction, along an isoparametric curve of constant w=t such th...">splitW</a>(w, patch00, patch01); <span class="comment">// 120 or 180 flops</span>
<a name="l00299"></a>00299         patch1.<a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a390a963fac70b68e5b61da6e1ac0c9e2" title="Split this patch into two along the w direction, along an isoparametric curve of constant w=t such th...">splitW</a>(w, patch10, patch11); <span class="comment">// 120 or 180 flops</span>
<a name="l00300"></a>00300     }
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00310"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ad3357ae426fbfbe7a023ee63be2b432a">00310</a> <a class="code" href="classSimTK_1_1Geo_1_1Sphere__.html" title="A geometric primitive representing a sphere by its radius and center point, and a collection of spher...">Geo::Sphere_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ad3357ae426fbfbe7a023ee63be2b432a" title="Return a sphere that surrounds the entire patch in the 0&lt;= u,w &lt;=1 range.">calcBoundingSphere</a>()<span class="keyword"> const </span>
<a name="l00311"></a>00311 <span class="keyword"></span>{   <span class="keyword">const</span> <a class="code" href="classSimTK_1_1ArrayViewConst__.html" title="This Array_ helper class is the base class for ArrayView_ which is the base class for Array_; here we...">ArrayViewConst_&lt;Vec3P&gt;</a> points(&amp;B(0,0), &amp;B(0,0)+16); <span class="comment">// no copy </span>
<a name="l00312"></a>00312     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ad3357ae426fbfbe7a023ee63be2b432a" title="Return a sphere that surrounds the entire patch in the 0&lt;= u,w &lt;=1 range.">Geo::Point_&lt;P&gt;::calcBoundingSphere</a>(points); }
<a name="l00313"></a>00313 
<a name="l00321"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afa0437892fe8889ee9e664656fbe1b86">00321</a> <a class="code" href="classSimTK_1_1Geo_1_1AlignedBox__.html" title="A 3d box aligned with an unspecified frame F and centered at a given point measured from that frame&#39;s...">Geo::AlignedBox_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afa0437892fe8889ee9e664656fbe1b86" title="Return an axis-aligned bounding box (AABB) that surrounds the entire patch segment in the 0&lt;= u...">calcAxisAlignedBoundingBox</a>()<span class="keyword"> const </span>
<a name="l00322"></a>00322 <span class="keyword"></span>{   <span class="keyword">const</span> <a class="code" href="classSimTK_1_1ArrayViewConst__.html" title="This Array_ helper class is the base class for ArrayView_ which is the base class for Array_; here we...">ArrayViewConst_&lt;Vec3P&gt;</a> points(&amp;B(0,0), &amp;B(0,0)+16); <span class="comment">// no copy </span>
<a name="l00323"></a>00323     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#afa0437892fe8889ee9e664656fbe1b86" title="Return an axis-aligned bounding box (AABB) that surrounds the entire patch segment in the 0&lt;= u...">Geo::Point_&lt;P&gt;::calcAxisAlignedBoundingBox</a>(points); }
<a name="l00324"></a>00324 
<a name="l00332"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a6348fb4073ca833e1d11ce17b2566d42">00332</a> <a class="code" href="classSimTK_1_1Geo_1_1OrientedBox__.html" title="TODO: A 3d box oriented and positioned with respect to an unspecified frame F.">Geo::OrientedBox_&lt;P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a6348fb4073ca833e1d11ce17b2566d42" title="Return an oriented bounding box (OBB) that surrounds the entire curve segment in the 0&lt;= u...">calcOrientedBoundingBox</a>()<span class="keyword"> const </span>
<a name="l00333"></a>00333 <span class="keyword"></span>{   <span class="keyword">const</span> <a class="code" href="classSimTK_1_1ArrayViewConst__.html" title="This Array_ helper class is the base class for ArrayView_ which is the base class for Array_; here we...">ArrayViewConst_&lt;Vec3P&gt;</a> points(&amp;B(0,0), &amp;B(0,0)+16); <span class="comment">// no copy </span>
<a name="l00334"></a>00334     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a6348fb4073ca833e1d11ce17b2566d42" title="Return an oriented bounding box (OBB) that surrounds the entire curve segment in the 0&lt;= u...">Geo::Point_&lt;P&gt;::calcOrientedBoundingBox</a>(points); }
<a name="l00335"></a>00335 
<a name="l00344"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a2a1988ebd2e5967aca7f60b3d71ddde8">00344</a> <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a2a1988ebd2e5967aca7f60b3d71ddde8" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the point P(u,w)=Fb(u)*B*~Fb(w) at that location, where Fb is a vector of Bezier basis functions.">evalPUsingB</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B, RealP u, RealP w) { 
<a name="l00345"></a>00345     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbu = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(u);     <span class="comment">// 9 flops</span>
<a name="l00346"></a>00346     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbw = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(w);     <span class="comment">// 9 flops</span>
<a name="l00347"></a>00347     <span class="keywordflow">return</span> Fbu * B * ~Fbw;                              <span class="comment">// 3x35 flops</span>
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00354"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae7b2f8c0bb9fa289571cdaa23639f0dd">00354</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae7b2f8c0bb9fa289571cdaa23639f0dd" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the tangents Pu(u,w)=dFb(u)*B*~Fb(w) and Pw(u,w)=Fb(u)*B*~dFb(w) at that location.">evalP1UsingB</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B, RealP u, RealP w,
<a name="l00355"></a>00355                          <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pu, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pw) {
<a name="l00356"></a>00356     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbu  = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(u);     <span class="comment">//  9 flops</span>
<a name="l00357"></a>00357     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbw  = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(w);     <span class="comment">//  9 flops</span>
<a name="l00358"></a>00358     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> dFbu = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcDFb</a>(u);    <span class="comment">// 10 flops</span>
<a name="l00359"></a>00359     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> dFbw = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcDFb</a>(w);    <span class="comment">// 10 flops</span>
<a name="l00360"></a>00360     Pu = dFbu * B * ~Fbw;                                <span class="comment">// 3x35</span>
<a name="l00361"></a>00361     Pw = Fbu  * B * ~dFbw;                               <span class="comment">// 3x35</span>
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 
<a name="l00368"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ab6e2ee49dc5b437dc9b0e388d3c78fae">00368</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ab6e2ee49dc5b437dc9b0e388d3c78fae" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the second derivatives Puu(u,w)=d2Fb(u)*B*~Fb(w), Puw(u,w)=dFb(u)*B*~dFb(w) and Pww(u,w)=Fb(u)*B*~d2Fb(w) at that location.">evalP2UsingB</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B, RealP u, RealP w,
<a name="l00369"></a>00369                          <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puu, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puw, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pww) {
<a name="l00370"></a>00370     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbu   = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(u);     <span class="comment">//  9 flops</span>
<a name="l00371"></a>00371     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbw   = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(w);     <span class="comment">//  9 flops</span>
<a name="l00372"></a>00372     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> dFbu  = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcDFb</a>(u);    <span class="comment">// 10 flops</span>
<a name="l00373"></a>00373     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> dFbw  = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcDFb</a>(w);    <span class="comment">// 10 flops</span>
<a name="l00374"></a>00374     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> d2Fbu = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcD2Fb</a>(u);   <span class="comment">//  5 flops</span>
<a name="l00375"></a>00375     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> d2Fbw = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcD2Fb</a>(w);   <span class="comment">//  5 flops</span>
<a name="l00376"></a>00376     Puu = d2Fbu * B * ~Fbw;                               <span class="comment">// 3x35</span>
<a name="l00377"></a>00377     Puw = dFbu  * B * ~dFbw;                              <span class="comment">// 3x35</span>
<a name="l00378"></a>00378     Pww = Fbu   * B * ~d2Fbw;                             <span class="comment">// 3x35</span>
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
<a name="l00385"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3226ab4adc8cc797c3ece56a65f77fb7">00385</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3226ab4adc8cc797c3ece56a65f77fb7" title="Given Bezier control points B and values for the curve parameters u and w in [0..1], return the third derivatives Puuu(u,w)=d3Fb(u)*B*~Fb(w), Puuw(u,w)=d2Fb(u)*B*~dFb(w), Puww(u,w)=dFb(u)*B*~d2Fb(w) and Pwww(u,w)=Fb(u)*B*~d3Fb(w) at that location.">evalP3UsingB</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B, RealP u, RealP w,
<a name="l00386"></a>00386                          <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puuu, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puuw, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Puww, <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Pwww) {
<a name="l00387"></a>00387     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbu   = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(u);     <span class="comment">//  9 flops</span>
<a name="l00388"></a>00388     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> Fbw   = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(w);     <span class="comment">//  9 flops</span>
<a name="l00389"></a>00389     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> dFbu  = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcDFb</a>(u);    <span class="comment">// 10 flops</span>
<a name="l00390"></a>00390     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> dFbw  = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcDFb</a>(w);    <span class="comment">// 10 flops</span>
<a name="l00391"></a>00391     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> d2Fbu = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcD2Fb</a>(u);   <span class="comment">//  5 flops</span>
<a name="l00392"></a>00392     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> d2Fbw = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcD2Fb</a>(w);   <span class="comment">//  5 flops</span>
<a name="l00393"></a>00393     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> d3Fbu = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcD3Fb</a>(u);   <span class="comment">//  0 </span>
<a name="l00394"></a>00394     <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,P&gt;</a> d3Fbw = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcD3Fb</a>(w);   <span class="comment">//  0</span>
<a name="l00395"></a>00395     Puuu = d3Fbu * B * ~Fbw;                              <span class="comment">// 3x35</span>
<a name="l00396"></a>00396     Puuw = d2Fbu * B * ~dFbw;                             <span class="comment">// 3x35</span>
<a name="l00397"></a>00397     Puww = dFbu  * B * ~d2Fbw;                            <span class="comment">// 3x35</span>
<a name="l00398"></a>00398     Pwww = Fbu   * B * ~d3Fbw;                            <span class="comment">// 3x35</span>
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00404"></a>00404 <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> 
<a name="l00405"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#af7e8f50d003f7282d09a203737db6105">00405</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a5712ceee630ada5eb4c548a6cca18e4c" title="Given a particular value u0 for patch coordinate u, create a cubic Bezier curve segment P(w)=P(u0...">calcIsoCurveU</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B, RealP u0) 
<a name="l00406"></a>00406 {   <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Row.html" title="Generic Row.">Row&lt;4,Vec3P&gt;</a> Bu0 = <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(u0) * B;
<a name="l00407"></a>00407     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(Bu0); }
<a name="l00408"></a>00408 
<a name="l00412"></a>00412 <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a> 
<a name="l00413"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ac725b3fed13d90b8575f4c5e99491299">00413</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a3944ac99fa1618353bfb1a2b7dae70a6" title="Given a particular value w0 for patch coordinate w, create a cubic Bezier curve segment P(u)=P(u...">calcIsoCurveW</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B, RealP w0)
<a name="l00414"></a>00414 {    <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Vec.html">Vec&lt;4,Vec3P&gt;</a> Bw0 = B * ~<a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;::calcFb</a>(w0);
<a name="l00415"></a>00415      <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Geo_1_1CubicBezierCurve__.html" title="This is a primitive useful for computations involving a single cubic Bezier curve segment...">CubicBezierCurve_&lt;P&gt;</a>(Bw0); }
<a name="l00416"></a>00416 
<a name="l00419"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#aa0ace21fdf4c99e3bf5f74b5ae893524">00419</a> <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#aa0ace21fdf4c99e3bf5f74b5ae893524" title="Given the Bezier control points B, return the equivalent vector algebraic coefficients A...">calcAFromB</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B) {
<a name="l00420"></a>00420     <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Coef;
<a name="l00421"></a>00421     Coef b11=B(0,0), b12=B(0,1), b13=B(0,2), b14=B(0,3), 
<a name="l00422"></a>00422          b21=B(1,0), b22=B(1,1), b23=B(1,2), b24=B(1,3), 
<a name="l00423"></a>00423          b31=B(2,0), b32=B(2,1), b33=B(2,2), b34=B(2,3), 
<a name="l00424"></a>00424          b41=B(3,0), b42=B(3,1), b43=B(3,2), b44=B(3,3); 
<a name="l00425"></a>00425     <span class="comment">// First calculate Mb*B:</span>
<a name="l00426"></a>00426     <span class="comment">//       a   b   c   d</span>
<a name="l00427"></a>00427     <span class="comment">//       e   f   g   h</span>
<a name="l00428"></a>00428     <span class="comment">//       p   q   r   s</span>
<a name="l00429"></a>00429     <span class="comment">//      b11 b12 b13 b14</span>
<a name="l00430"></a>00430     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> a= b41-b11+3*(b21-b31), b= b42-b12+3*(b22-b32),   <span class="comment">// 3x16 flops</span>
<a name="l00431"></a>00431           c= b43-b13+3*(b23-b33), d= b44-b14+3*(b24-b34);
<a name="l00432"></a>00432     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> e= 3*(b11+b31)-6*b21,   f= 3*(b12+b32)-6*b22,     <span class="comment">// 3x16 flops</span>
<a name="l00433"></a>00433           g= 3*(b13+b33)-6*b23,   h= 3*(b14+b34)-6*b24;
<a name="l00434"></a>00434     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> p= 3*(b21-b11),         q= 3*(b22-b12),           <span class="comment">// 3x8 flops</span>
<a name="l00435"></a>00435           r= 3*(b23-b13),         s= 3*(b24-b14);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     <span class="comment">// Then calculate (Mb*B)*~Mb. (3x40 more flops)</span>
<a name="l00438"></a>00438     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>
<a name="l00439"></a>00439        ( d-a+3*(b-c),          3*(a+c)-6*b,       3*(b-a),        a,
<a name="l00440"></a>00440          h-e+3*(f-g),          3*(e+g)-6*f,       3*(f-e),        e,
<a name="l00441"></a>00441          s-p+3*(q-r),          3*(p+r)-6*q,       3*(q-p),        p,
<a name="l00442"></a>00442          b14-b11+3*(b12-b13),  3*(b11+b13)-6*b12, 3*(b12-b11),   b11 );
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00447"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae8f5d0fcfd8fa564a7990d036e924c6c">00447</a> <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae8f5d0fcfd8fa564a7990d036e924c6c" title="Given the vector algebraic coefficients A, return the equivalent Bezier control points B...">calcBFromA</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; A) {
<a name="l00448"></a>00448     <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Coef;
<a name="l00449"></a>00449     Coef a33=A(0,0), a32=A(0,1), a31=A(0,2), a30=A(0,3), 
<a name="l00450"></a>00450          a23=A(1,0), a22=A(1,1), a21=A(1,2), a20=A(1,3), 
<a name="l00451"></a>00451          a13=A(2,0), a12=A(2,1), a11=A(2,2), a10=A(2,3), 
<a name="l00452"></a>00452          a03=A(3,0), a02=A(3,1), a01=A(3,2), a00=A(3,3); 
<a name="l00453"></a>00453     <span class="comment">// First calculate Mb^-1*A:</span>
<a name="l00454"></a>00454     <span class="comment">//      a03 a02 a01 a00</span>
<a name="l00455"></a>00455     <span class="comment">//       a   b   c   d</span>
<a name="l00456"></a>00456     <span class="comment">//       e   f   g   h</span>
<a name="l00457"></a>00457     <span class="comment">//       p   q   r   s</span>
<a name="l00458"></a>00458     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> a=a13/3+a03, b=a12/3+a02, c=a11/3+a01, d=a10/3+a00;   <span class="comment">// 3x8 flops</span>
<a name="l00459"></a>00459     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> e=(a23+2*a13)/3+a03, f=(a22+2*a12)/3+a02,             <span class="comment">// 3x16 flops</span>
<a name="l00460"></a>00460           g=(a21+2*a11)/3+a01, h=(a20+2*a10)/3+a00;
<a name="l00461"></a>00461     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> p=a33+a23+a13+a03, q=a32+a22+a12+a02,                 <span class="comment">// 3x12 flops</span>
<a name="l00462"></a>00462           r=a31+a21+a11+a01, s=a30+a20+a10+a00;
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="comment">// Then calculate (Mb^-1*A)*Mb^-T (3x36 more flops)</span>
<a name="l00466"></a>00466     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>
<a name="l00467"></a>00467        ( a00,   a01/3+a00,  (a02+2*a01)/3+a00,     a03+a02+a01+a00,
<a name="l00468"></a>00468           d,      c/3+d,       (b+2*c)/3+d,             a+b+c+d,
<a name="l00469"></a>00469           h,      g/3+h,       (f+2*g)/3+h,             e+f+g+h,
<a name="l00470"></a>00470           s,      r/3+s,       (q+2*r) /3+s,            p+q+r+s     );
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00475"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae8ddc97035940c8db83bb4a92da17bac">00475</a> <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#ae8ddc97035940c8db83bb4a92da17bac" title="Given the Bezier control points B, return the equivalent vector Hermite coefficients H...">calcHFromB</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; B) {
<a name="l00476"></a>00476     <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Coef;
<a name="l00477"></a>00477     Coef b11=B(0,0), b12=B(0,1), b13=B(0,2), b14=B(0,3), 
<a name="l00478"></a>00478          b21=B(1,0), b22=B(1,1), b23=B(1,2), b24=B(1,3), 
<a name="l00479"></a>00479          b31=B(2,0), b32=B(2,1), b33=B(2,2), b34=B(2,3), 
<a name="l00480"></a>00480          b41=B(3,0), b42=B(3,1), b43=B(3,2), b44=B(3,3); 
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <span class="comment">// First calculate a few temps -- see class comments. (3x4 flops)</span>
<a name="l00483"></a>00483     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> b12mb11=b12-b11, b24mb14=b24-b14, b42mb41=b42-b41, b44mb34=b44-b34;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485     <span class="comment">// Then calculate (Mh^-1 Mb) B ~(Mh^-1 Mb). (3x24 more flops)</span>
<a name="l00486"></a>00486     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>
<a name="l00487"></a>00487        (     b11,         b14,          3*b12mb11,           3*(b14-b13),
<a name="l00488"></a>00488              b41,         b44,          3*b42mb41,           3*(b44-b43),
<a name="l00489"></a>00489          3*(b21-b11),  3*b24mb14,  9*(b22-b21-b12mb11),  9*(b24mb14+b13-b23),
<a name="l00490"></a>00490          3*(b41-b31),  3*b44mb34,  9*(b42mb41+b31-b32),  9*(b44mb34+b33-b43) );
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00495"></a><a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a01aaf5533863ef2f12f46912d2c18c23">00495</a> <span class="keyword">static</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> <a class="code" href="classSimTK_1_1Geo_1_1BicubicBezierPatch__.html#a01aaf5533863ef2f12f46912d2c18c23" title="Given the vector Hermite coefficients H, return the equivalent Bezier control points B...">calcBFromH</a>(<span class="keyword">const</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>&amp; H) {
<a name="l00496"></a>00496     <span class="keyword">typedef</span> <span class="keyword">const</span> <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a>&amp; Coef;
<a name="l00497"></a>00497     Coef h00=H(0,0), h01=H(0,1), w00=H(0,2), w01=H(0,3), 
<a name="l00498"></a>00498          h10=H(1,0), h11=H(1,1), w10=H(1,2), w11=H(1,3), 
<a name="l00499"></a>00499          u00=H(2,0), u01=H(2,1), t00=H(2,2), t01=H(2,3), 
<a name="l00500"></a>00500          u10=H(3,0), u11=H(3,1), t10=H(3,2), t11=H(3,3); 
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="comment">// First calculate a few temps -- see class comments. (3x8 flops)</span>
<a name="l00503"></a>00503     <a class="code" href="classSimTK_1_1Vec.html">Vec3P</a> tmp00=h00+u00/3, tmp01=h01+u01/3, 
<a name="l00504"></a>00504           tmp10=h10-u10/3, tmp11=h11-u11/3;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     <span class="comment">// Then calculate (Mb^-1 Mh) H ~(Mb^-1 Mh). (3x24 more flops)</span>
<a name="l00507"></a>00507     <span class="keywordflow">return</span> <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a>
<a name="l00508"></a>00508        (  h00,       h00+w00/3,          h01-w01/3,       h01,
<a name="l00509"></a>00509          tmp00,  tmp00+w00/3+t00/9,  tmp01-w01/3-t01/9,  tmp01,
<a name="l00510"></a>00510          tmp10,  tmp10+w10/3-t10/9,  tmp11-w11/3+t11/9,  tmp11,
<a name="l00511"></a>00511           h10,       h10+w10/3,          h11-w11/3,       h11  );
<a name="l00512"></a>00512 }
<a name="l00515"></a>00515 <span class="keyword">private</span>:
<a name="l00516"></a>00516 <a class="code" href="classSimTK_1_1Mat.html">Mat&lt;4,4,Vec3P&gt;</a> B;   <span class="comment">// 16 Bezier control points; see above for definition</span>
<a name="l00517"></a>00517 };
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 } <span class="comment">// namespace SimTK</span>
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 <span class="preprocessor">#endif // SimTK_SIMMATH_GEO_BICUBIC_BEZIER_PATCH_H_</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="Geo__BicubicBezierPatch_8h.html">Geo_BicubicBezierPatch.h</a>      </li>

    <li class="footer">Generated on Mon Jul 14 2014 23:25:46 for Simbody by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
