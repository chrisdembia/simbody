<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Simbody: SimTK::SemiExplicitEulerIntegrator Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Simbody
   &#160;<span id="projectnumber">3.4 (development)</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classSimTK_1_1SemiExplicitEulerIntegrator.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">SimTK::SemiExplicitEulerIntegrator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="SimTK::SemiExplicitEulerIntegrator" --><!-- doxytag: inherits="SimTK::Integrator" -->
<p>This is an implementation of the fixed-step Semi-Explicit Euler method, also known as Semi-Implicit Euler or Symplectic Euler.  
 <a href="classSimTK_1_1SemiExplicitEulerIntegrator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SemiExplicitEulerIntegrator_8h_source.html">SemiExplicitEulerIntegrator.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for SimTK::SemiExplicitEulerIntegrator:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="classSimTK_1_1SemiExplicitEulerIntegrator.png" usemap="#SimTK::SemiExplicitEulerIntegrator_map" alt=""/>
  <map id="SimTK::SemiExplicitEulerIntegrator_map" name="SimTK::SemiExplicitEulerIntegrator_map">
<area href="classSimTK_1_1Integrator.html" title="An Integrator is an object that can advance the State of a System through time." alt="SimTK::Integrator" shape="rect" coords="0,0,204,24"/>
</map>
 </div></div>

<p><a href="classSimTK_1_1SemiExplicitEulerIntegrator-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimTK_1_1SemiExplicitEulerIntegrator.html#ac7d19dc9bb01f48f195248603440f09e">SemiExplicitEulerIntegrator</a> (const <a class="el" href="classSimTK_1_1System.html">System</a> &amp;sys, Real stepSize)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="classSimTK_1_1SemiExplicitEulerIntegrator.html" title="This is an implementation of the fixed-step Semi-Explicit Euler method, also known as Semi-Implicit E...">SemiExplicitEulerIntegrator</a> for integrating a <a class="el" href="classSimTK_1_1System.html" title="This is the base class that serves as the parent of all SimTK System objects; most commonly Simbody&#39;s...">System</a> with fixed size steps.  <a href="#ac7d19dc9bb01f48f195248603440f09e"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This is an implementation of the fixed-step Semi-Explicit Euler method, also known as Semi-Implicit Euler or Symplectic Euler. </p>
<p>This method is very popular for game engines such as ODE, because it is a first order method that is more stable than Explicit Euler. However, the implementation used in gaming is fully explicit, which is only correct if there are no velocity-dependent force elements. Coriolis forces, damping, etc. would require an implicit solution which is generally too slow for real time simulation.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>There is no error estimator for this integrator so it cannot adjust the step size. It is given a fixed step size on construction and will use that unless you change it. The step size may be reduced to isolate events, and the method is capable of interpolation (linear) if you want reports at shorter intervals than the step size.</dd></dl>
<h3>Theory</h3>
<p>The correct implementation of this method is described in Geometric Numerical Integration, Hairer, Lubich &amp; Wanner 2006, page 3. The method applies to a system of differential equations that can be partitioned like this: </p>
<pre>
    udot = udot(q,u)
    qdot = qdot(q,u)
         = N(q)u      in Simbody
</pre><p> Semi-Implicit Euler treats one variable implicitly, and the other explicitly, producing two different possible forms: </p>
<pre>
Form 1:
    q1 = q0 + h qdot(q1,u0)   &lt;-- implicit in q
    u1 = u0 + h udot(q1,u0)
Form 2:
    u1 = u0 + h udot(q0,u1)   &lt;-- implicit in u
    q1 = q0 + h qdot(q0,u1)
</pre><p> If udot were udot(q) only, Form 2 would be </p>
<pre>
    u1 = u0 + h udot(q0)      &lt;-- if no velocity dependence
    q1 = q0 + h N(q0)u1
</pre><p> That would be a correct, yet fully explicit implementation of Symplectic Euler. Instead, the standard gaming implementation is </p>
<pre>
    u1 = u0 + h udot(q0,u0)   &lt;-- wrong; should be implicit in u
    q1 = q0 + h N(q0)u1
</pre><p> This differs from a true Symplectic Euler by however much the velocity- dependent forces change from u0 to u1. If they are very small, no great loss. That may be less likely in internal coordinates though. Making this implicit would be quite expensive since we don't have analytical partial derivatives of udot available.</p>
<p>Form 1 on the other hand could be implemented efficiently as a true semi-implicit method: </p>
<pre>
    q1 = q0 + h N(q1)u0       &lt;-- implicit in q
    u1 = u0 + h udot(q1,u0)
</pre><p> The directional partial derivatives D N(q)*u0 / D q are easily calculated for the block diagonal matrix N which in many cases is just an identity matrix. A disadvantage is that accelerations are unknown at (q0,u0) and (q1,u1); if those are needed (very common!) a second evaluation of the accelerations would be required. For that expense, a second order integration method could have been used instead. I also don't know whether this form would have the same stability properties in practice as the other one; it would be interesting to experiment. However, for now we use Form 2 in the gamer's fully-explicit style. This will not work well in the presence of huge damping forces and probably not for very high rotation rates either! </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac7d19dc9bb01f48f195248603440f09e"></a><!-- doxytag: member="SimTK::SemiExplicitEulerIntegrator::SemiExplicitEulerIntegrator" ref="ac7d19dc9bb01f48f195248603440f09e" args="(const System &amp;sys, Real stepSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSimTK_1_1SemiExplicitEulerIntegrator.html#ac7d19dc9bb01f48f195248603440f09e">SimTK::SemiExplicitEulerIntegrator::SemiExplicitEulerIntegrator</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSimTK_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>stepSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a <a class="el" href="classSimTK_1_1SemiExplicitEulerIntegrator.html" title="This is an implementation of the fixed-step Semi-Explicit Euler method, also known as Semi-Implicit E...">SemiExplicitEulerIntegrator</a> for integrating a <a class="el" href="classSimTK_1_1System.html" title="This is the base class that serves as the parent of all SimTK System objects; most commonly Simbody&#39;s...">System</a> with fixed size steps. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="SemiExplicitEulerIntegrator_8h_source.html">SemiExplicitEulerIntegrator.h</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceSimTK.html">SimTK</a>      </li>
      <li class="navelem"><a class="el" href="classSimTK_1_1SemiExplicitEulerIntegrator.html">SemiExplicitEulerIntegrator</a>      </li>

    <li class="footer">Generated on Mon Jul 14 2014 23:26:14 for Simbody by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
